<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>South Star Xelerator</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/stylish-portfolio.css" rel="stylesheet">
    <link href="css/style-card.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">



</head>

<body>

    <!-- Navigation -->
    <a id="menu-toggle" href="#" class="btn btn-dark btn-lg toggle"><i class="fa fa-bars" ></i></a>
    <nav id="sidebar-wrapper">
        <ul class="sidebar-nav">
            <a id="menu-close" href="#" class="btn btn-light btn-lg pull-right toggle"><i class="fa fa-times"></i></a>
            <li class="sidebar-brand">
                <a href="#top" onclick=$("#menu-close").click();>South Star Xelerator</a>
            </li>
            <li>
                <a href="#top" onclick=$("#menu-close").click();>Home</a>
            </li>
            <li>
                <a href="#about" onclick=$("#menu-close").click();>About</a>
            </li>
            <li>
                <a href="#services" onclick=$("#menu-close").click();>Favorite</a>
            </li>
            <li>
                <a href="#portfolio" onclick=$("#menu-close").click();>Portfolio</a>
            </li>
            <li>
                <a href="#contact" onclick=$("#menu-close").click();>Contact</a>
            </li>
        </ul>
    </nav>

    <!-- Header -->
    <header id="top" class="header">
        <div class="text-vertical-center">
            <br>
            <a href="#about" class="" style="color:white;background-color:black;" ></a>



            </a> 
        </div>
        <div class="text-horizontal-center" style="position:absolute;right:25px;">

            <a href="#about" class="btn btn-dark btn-lg" style="font-family:Microsoft JhengHei;">發起議題</a> 

            <a href="#about" class="" style="color:black;margin:25px;font-weight:bold;font-family:Microsoft JhengHei;">登入</a>   

            <a href="#about" class="" style="color:black;font-weight:bold;font-family:Microsoft JhengHei;">註冊</a> 
        </div>
    </header>

    <sidebar class="sidebar" style="width:120px;float:left;font-family:Microsoft JhengHei;height:280px;text-align:center;line-height:30px;font-size:15px;color:black;">
    <br>
    <br>
    <br>
    <p style="color:orange;font-weight:bold;">類型</p>
    宿舍(2)<br>
    校務會議(4)<br>
    學生權益(5)<br>
    </sidebar>


    <!-- About -->
    <section id="about" class="about">
        <div class="text-horizontal-center" style="text-align:center;">
            <br>
            <a href="#about" class="" style="color:white;margin:25px;font-family:Microsoft JhengHei;">最近議題</a>

            <a href="#about" class="" style="color:white;margin:25px;font-family:Microsoft JhengHei;">熱門議題</a>   

            <a href="#about" input type="button" style="width:50px;height:30px;background-color:lightgrey;border:10px;margin:5px;border-radius: 3px;">Tag</a> 
            <a href="#about" class="" style="color:white;margin:5px;font-family:Microsoft JhengHei;">車管會</a>  
            <a href="#about" class="" style="color:white;margin:5px;font-family:Microsoft JhengHei;">門禁</a>  
            <a href="#about" class="" style="color:white;margin:5px;font-family:Microsoft JhengHei;">流浪狗</a>  
            <a href="#about" class="" style="color:white;margin:5px;font-family:Microsoft JhengHei;">校園公車</a> 
            <a>
                <form style="float:right;">
                    <select name="YourLocation" style="font-family:Microsoft JhengHei;border-radius: 10px;">
                    　<option value="" style="font-family:Microsoft JhengHei;">投票中</option>
                    　<option value="" style="font-family:Microsoft JhengHei;">已結束</option>
                    　...
                    </select>
                </form>
            </a> 
        </div>
    </section>

    <section style="margin:0 auto;background-position:center;font-family:Microsoft JhengHei;text-align:center;font-size:0.7cm;width: 50%;height: 100%;background-color: lightgrey;">
        
        <div class="tagBtn_container"></div>
        <div class="card_container"></div>

    </section>

    <!-- Callout -->
    <aside class="callout">
        <div class="text-vertical-center" style="font-family:Microsoft JhengHei;">
            <h1>南 星 創 速 器</h1>
        </div>
    </aside>

    



    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1 text-center">
                    <h4><strong>South Star Xelerator</strong>
                    </h4>
                    <ul class="list-unstyled">
                        <li><i class="fa fa-phone fa-fw"></i> (123) 456-7890</li>
                        <li><i class="fa fa-envelope-o fa-fw"></i> <a href="mailto:name@example.com">name@example.com</a>
                        </li>
                    </ul>
                    <br>
                    <hr class="small">
                    <p class="text-muted">Copyright &copy; All Rights Reserved by South Star Xelerator 2016</p>
                </div>
            </div>
        </div>
        <a id="to-top" href="#top" class="btn btn-dark btn-lg"><i class="fa fa-chevron-up fa-fw fa-1x"></i></a>
    </footer>

    <!-- jQuery -->
    <script src="js/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Custom js functions for card -->
    <script src="js/card.js"></script>

    <!-- Custom Theme JavaScript -->
    <script>
    // Closes the sidebar menu
    $("#menu-close").click(function(e) {
        e.preventDefault();
        $("#sidebar-wrapper").toggleClass("active");
    });
    // Opens the sidebar menu
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#sidebar-wrapper").toggleClass("active");
    });
    // Scrolls to the selected menu item on the page
    // $(function() {
    //     $('a[href*=#]:not([href=#],[data-toggle],[data-target],[data-slide])').click(function() {
    //         if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') || location.hostname == this.hostname) {
    //             var target = $(this.hash);
    //             target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
    //             if (target.length) {
    //                 $('html,body').animate({
    //                     scrollTop: target.offset().top
    //                 }, 1000);
    //                 return false;
    //             }
    //         }
    //     });
    // });
    //#to-top button appears after scrolling
    var fixed = false;
    $(document).scroll(function() {
        if ($(this).scrollTop() > 250) {
            if (!fixed) {
                fixed = true;
                // $('#to-top').css({position:'fixed', display:'block'});
                $('#to-top').show("slow", function() {
                    $('#to-top').css({
                        position: 'fixed',
                        display: 'block'
                    });
                });
            }
        } else {
            if (fixed) {
                fixed = false;
                $('#to-top').hide("slow", function() {
                    $('#to-top').css({
                        display: 'none'
                    });
                });
            }
        }
    });
    
    </script>

    <!-- Custom Js for showing issues -->
    <script>

        // This function is for development
        function generateButton(){
            // Generate show all issues button
            let showAll_btn = document.createElement("button");

            // Set the property of the button
            $(showAll_btn)
            .attr("title", "Show all issues")
            .addClass("button")
            .html('Show all issues')
            .on("click", function(event){
                loadingCardAnimation();
                $.ajax({
                    url: 'https://stormy-fjord-31975.herokuapp.com/apis/issue',
                    type: "GET",
                    dataType: 'json',
                    xhrFields: {
                      withCredentials: true
                    },
                    success: function(response){
                        // debug
                        // console.log("%cSuccesfully show the cards having the tag 'Tainan'!","font-weight: bold; color: blue");
                        showCards( response.issueList );            
                    },
                    error:function(xhr, ajaxOptions, thrownError){ 
                        console.log("<id="+i+">" + "card status:" + ixhr.status); 
                        console.log("error:" + thrownError); 
                    }
                });
            });
            $(".tagBtn_container").append(showAll_btn);

            {
                // Generate Tainan tag button
                let tagName = 'Tainan';
                let button = document.createElement("button");
                let buttonHTML = tagName;

                // Set the property of the button
                $(button)
                .attr("title", "Show all issues that have the tag Tainan")
                .addClass("tag_button")
                .html(buttonHTML)
                .on("click", function(event){
                    loadingCardAnimation();
                    $.ajax({
                        url: 'https://stormy-fjord-31975.herokuapp.com/apis/issue?tags_list=' + tagName,
                        type: "GET",
                        dataType: 'json',
                        xhrFields: {
                          withCredentials: true
                        },
                        success: function(response){
                            // debug
                            console.log("%cSuccesfully show the cards having the tag '"+ tagName +"'!","font-weight: bold; color: blue");
                            showCards( response.issueList );            
                        },
                        error:function(xhr, ajaxOptions, thrownError){ 
                            console.log("<id="+i+">" + "card status:" + ixhr.status); 
                            console.log("error:" + thrownError); 
                        }
                    });
                });
                $(".tagBtn_container").append(button);
            }
            

            // Generate cars tag button
            {
                let tagName = 'cars';
                let button = document.createElement("button");
                let buttonHTML = tagName;

                // Set the property of the button
                $(button)
                .attr("title", "Show all issues that have the tag Tainan")
                .addClass("tag_button")
                .html(buttonHTML)
                .on("click", function(event){
                    loadingCardAnimation();
                    $.ajax({
                        url: 'https://stormy-fjord-31975.herokuapp.com/apis/issue?tags_list=' + tagName,
                        type: "GET",
                        dataType: 'json',
                        xhrFields: {
                          withCredentials: true
                        },
                        success: function(response){
                            // debug
                            console.log("%cSuccesfully show the cards having the tag '"+ tagName +"'!","font-weight: bold; color: blue");
                            showCards( response.issueList );            
                        },
                        error:function(xhr, ajaxOptions, thrownError){ 
                            console.log("<id="+i+">" + "card status:" + ixhr.status); 
                            console.log("error:" + thrownError); 
                        }
                    });
                });
                $(".tagBtn_container").append(button);
            }
            
        }

        function loadingCardAnimation() {
            let loading = '<div class="loading"></div>';
            $(".card_container").html(loading);  // 先將內容改成loading
        }

        function showAllIssues(){

            // 在ajax完成以前先顯示loading動畫
            loadingCardAnimation();
            // 讀入各個卡片的資訊
            $.ajax({
                url: 'https://stormy-fjord-31975.herokuapp.com/apis/issue',
                type: "GET",
                dataType: 'json',
                xhrFields: {
                  withCredentials: true
                },
                success: function(response){
                    // debug
                    console.log("%cSuccesfully get data from database!","font-weight: bold; color: blue");
                    showCards( response.issueList );            
                },
                error:function(xhr, ajaxOptions, thrownError){ 
                    console.log("<id="+i+">" + "card status:" + ixhr.status); 
                    console.log("error:" + thrownError);
                }
            });
        }

        // --- Main ---

        $(document).ready(function(){

            console.log("%c💩💩💩💩💩💩💩💩💩💩","font-weight: bold;font-size: 25px; color: red");
            showAllIssues();
            // 產生按鈕並設定按鈕的行為
            generateButton();

        });

    </script>


    <style type="text/css">
#Header{
　width:360px;
　height:80px;
　text-align:center;
　line-height:80px;
　font-size:15px;
　color:#fffaf3;
　font-weight:bold;
　background-color:#f9c81e;
}
#Sidebar{
　width:120px;
　float:left;
　height:280px;
　text-align:center;
　line-height:280px;
　font-size:15px;
　color:#ffffff;
　font-weight:bold;
　background-color:#cecece;
}
#body{
　width:240px;
　height:280px;
　text-align:center;
　line-height:280px;
　font-size:15px;
　color:#f9c81e;
　font-weight:bold;
　background-color:#fffaf3;
　float:left;
}
#Footer{
　width:360px;
　height:80px;
　text-align:center;
　line-height:80px;
　font-size:15px;
　color:#fffaf3;
　font-weight:bold;
　background-color:#f9c81e;
}
</style>

</body>

</html>
